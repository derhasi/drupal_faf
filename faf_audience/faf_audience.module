<?php

/**
 * @file
 *   This module provides an API to define a audience via audience types.
 *   This information will be used by faf to define access groups.
 */

/**
 * Wrapper function for loading types via ctools plugin.
 */
function faf_audience_get_types() {
  ctools_include('plugins');
  return ctools_get_plugins('faf_audience', 'audience_types');
}

/**
 * Wrapper function for loading a single audience type, using ctools plugin.
 */
function faf_audience_get_type($audience_type) {
  ctools_include('plugins');
  return ctools_get_plugins('faf_audience', 'audience_types', $audience_type);
}

/**
 * Implementation of pseudohook_ctools_plugin_PLUGINTYPE().
 *
 * Inform CTools about default values for the plugin implementation.
 */
function faf_audience_ctools_plugin_audience_types() {
  return array(
    'defaults' => array(
      // A callback function
      'member callback' => NULL,
      // Define configuration options
      //'config' => array(
      //  '#type' => 'select',
      //  '#multiple' => FALSE,
      //  '#required' => FALSE,
      //  '#options' => array(),
      //),
    ),
    //'process' => '_faf_audience_ctools_plugin_process',
  );
}

/**
 * Implement hook_ctools_plugin_directory().
 *
 * So we can define some data for different plugins, as faf_audience_types.
 */
function faf_audience_ctools_plugin_directory($module, $plugin) {
  if ($module == 'faf_audience' && $plugin == 'audience_types') {
    return 'plugins/audience_types';
  }
}

//----- Audience (Exportables) ----//

/**
 * Implementation of hook_ctools_plugin_api().
 *
 * Tell CTools that we support the default_faf_audience API.
 */
function faf_audience_ctools_plugin_api($owner, $api) {
  if ($owner == 'faf_audience' && $api == 'default_faf_audience') {
    return array('version' => 1);
  }
}

/**
* Implementation of hook_default_faf_audience().
*
* Provide a couple of default presets for
*/
function faf_audience_default_faf_audience() {
  $export = array();

  // Super User ($user->uid == 1)
  $preset = new stdClass;
  $preset->api_version = 1;
  $preset->name = 'user_1';
  $preset->description = 'Super user';
  $preset->atype = 'user';
  $preset->option = '1';
  $preset->config = NULL;
  $export['user_1'] = $preset;

  return $export;
}